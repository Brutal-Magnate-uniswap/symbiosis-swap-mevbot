# This transport is used for handling file addresses generated by alias
# or .forward files if the path ends in "/", which causes it to be treated
# as a directory name rather than a file name.

address_directory:
  debug_print = "T: address_directory for $local_part@$domain"
  driver = appendfile
  envelope_to_add = true
  return_path_add = true
  # This is enabled by default, but just to be explicit..
  create_directory
  check_string = ""
  escape_string = ""
  maildir_format
  maildir_use_size_file
  # 
  # Work out if this is a symbiosis domain
  # and See if a per-domain quota has been set.
  #  a) Use the per-user quota if set
  #  b) Use the per-domain quota if set
  #  b) Use a zero quota
  quota = ${if exists{VHOST_DIR/${domain}/VHOST_MAILBOX_DIR/${local_part}/mailbox_quota} \
            {${readfile{VHOST_DIR/${domain}/VHOST_MAILBOX_DIR/${local_part}/mailbox_quota}}} \
 	    { \
              ${if exists{VHOST_DIR/${domain}/VHOST_CONFIG_DIR/mailbox_quota} \
                {${readfile{VHOST_DIR/${domain}/VHOST_CONFIG_DIR/mailbox_quota}}} \
	        {0}} \
            } \
          }
  allow_symlink

